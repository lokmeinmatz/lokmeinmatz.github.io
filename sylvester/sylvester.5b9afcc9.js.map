{"version":3,"sources":["index.ts"],"names":[],"mappings":";AA+QC,SAAA,EAAA,GAAA,OAAA,EAAA,mBAAA,QAAA,iBAAA,OAAA,SAAA,SAAA,GAAA,cAAA,GAAA,SAAA,GAAA,OAAA,GAAA,mBAAA,QAAA,EAAA,cAAA,QAAA,IAAA,OAAA,UAAA,gBAAA,IAAA,GAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,EAAA,oBAAA,SAAA,QAAA,IAAA,QAAA,IAAA,SAAA,EAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,IAAA,EAAA,OAAA,yBAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,IAAA,KAAA,GAAA,EAAA,SAAA,EAAA,EAAA,GAAA,GAAA,SAAA,EAAA,EAAA,GAAA,MAAA,OAAA,UAAA,eAAA,KAAA,EAAA,IAAA,QAAA,EAAA,EAAA,MAAA,OAAA,EAAA,SAAA,EAAA,EAAA,GAAA,GAAA,mBAAA,GAAA,OAAA,EAAA,MAAA,IAAA,UAAA,sDAAA,EAAA,UAAA,OAAA,OAAA,GAAA,EAAA,UAAA,CAAA,YAAA,CAAA,MAAA,EAAA,UAAA,EAAA,cAAA,KAAA,GAAA,EAAA,EAAA,GAAA,SAAA,EAAA,EAAA,GAAA,OAAA,EAAA,OAAA,gBAAA,SAAA,EAAA,GAAA,OAAA,EAAA,UAAA,EAAA,IAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,IAAA,OAAA,WAAA,IAAA,EAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,IAAA,EAAA,EAAA,MAAA,YAAA,EAAA,QAAA,UAAA,EAAA,UAAA,QAAA,EAAA,EAAA,MAAA,KAAA,WAAA,OAAA,EAAA,KAAA,IAAA,SAAA,EAAA,EAAA,GAAA,OAAA,GAAA,WAAA,EAAA,IAAA,mBAAA,EAAA,EAAA,GAAA,EAAA,SAAA,EAAA,GAAA,QAAA,IAAA,EAAA,MAAA,IAAA,eAAA,6DAAA,OAAA,EAAA,SAAA,IAAA,GAAA,oBAAA,UAAA,QAAA,UAAA,OAAA,EAAA,GAAA,QAAA,UAAA,KAAA,OAAA,EAAA,GAAA,mBAAA,MAAA,OAAA,EAAA,IAAA,OAAA,KAAA,UAAA,SAAA,KAAA,QAAA,UAAA,KAAA,GAAA,gBAAA,EAAA,MAAA,GAAA,OAAA,GAAA,SAAA,EAAA,GAAA,OAAA,EAAA,OAAA,eAAA,OAAA,eAAA,SAAA,GAAA,OAAA,EAAA,WAAA,OAAA,eAAA,KAAA,GAAA,SAAA,EAAA,EAAA,GAAA,KAAA,aAAA,GAAA,MAAA,IAAA,UAAA,qCAAA,SAAA,EAAA,EAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,OAAA,IAAA,CAAA,IAAA,EAAA,EAAA,GAAA,EAAA,WAAA,EAAA,aAAA,EAAA,EAAA,cAAA,EAAA,UAAA,IAAA,EAAA,UAAA,GAAA,OAAA,eAAA,EAAA,EAAA,IAAA,IAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,GAAA,EAAA,EAAA,UAAA,GAAA,GAAA,EAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,IAAA,SAAA,IAAA,MAAA,IAAA,UAAA,6IAAA,SAAA,EAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,OAAA,YAAA,OAAA,GAAA,CAAA,IAAA,EAAA,GAAA,GAAA,EAAA,GAAA,EAAA,OAAA,EAAA,IAAA,IAAA,IAAA,EAAA,EAAA,EAAA,OAAA,cAAA,GAAA,EAAA,EAAA,QAAA,QAAA,EAAA,KAAA,EAAA,QAAA,GAAA,EAAA,SAAA,GAAA,GAAA,IAAA,MAAA,GAAA,GAAA,EAAA,EAAA,EAAA,QAAA,IAAA,GAAA,MAAA,EAAA,QAAA,EAAA,SAAA,QAAA,GAAA,EAAA,MAAA,GAAA,OAAA,GAAA,SAAA,EAAA,GAAA,GAAA,MAAA,QAAA,GAAA,OAAA,EAAA,SAAA,EAAA,EAAA,GAAA,IAAA,EAAA,GAAA,oBAAA,QAAA,MAAA,EAAA,OAAA,UAAA,CAAA,GAAA,MAAA,QAAA,KAAA,EAAA,EAAA,KAAA,GAAA,GAAA,iBAAA,EAAA,OAAA,CAAA,IAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,aAAA,MAAA,CAAA,EAAA,EAAA,EAAA,WAAA,OAAA,GAAA,EAAA,OAAA,CAAA,MAAA,GAAA,CAAA,MAAA,EAAA,MAAA,EAAA,OAAA,EAAA,SAAA,GAAA,MAAA,GAAA,EAAA,GAAA,MAAA,IAAA,UAAA,yIAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAA,MAAA,CAAA,EAAA,WAAA,EAAA,EAAA,OAAA,aAAA,EAAA,WAAA,IAAA,EAAA,EAAA,OAAA,OAAA,EAAA,EAAA,KAAA,GAAA,EAAA,SAAA,GAAA,GAAA,EAAA,EAAA,GAAA,EAAA,WAAA,IAAA,GAAA,MAAA,EAAA,QAAA,EAAA,SAAA,QAAA,GAAA,EAAA,MAAA,KAAA,SAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,GAAA,iBAAA,EAAA,OAAA,EAAA,EAAA,GAAA,IAAA,EAAA,OAAA,UAAA,SAAA,KAAA,GAAA,MAAA,GAAA,GAAA,MAAA,WAAA,GAAA,EAAA,cAAA,EAAA,EAAA,YAAA,MAAA,QAAA,GAAA,QAAA,EAAA,MAAA,KAAA,GAAA,cAAA,GAAA,2CAAA,KAAA,GAAA,EAAA,EAAA,QAAA,GAAA,SAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,UAAA,EAAA,EAAA,QAAA,IAAA,IAAA,EAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EA/QD,IACI,EACA,EAFE,EAAO,KAAK,MAAQ,KAM1B,SAAS,EAAS,EAAW,EAAW,GAChC,IAAA,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAMjB,OAHR,EAAI,GAAK,EAAI,GACb,EAAI,GAAK,GAFT,EAAQ,EAAJ,GADJ,EAAI,KAAK,MAAU,EAAJ,KAGE,GACjB,EAAI,GAAK,GAAK,EAAI,GAAK,GACf,EAAI,GACH,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,MACxB,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,MACxB,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,MACxB,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,MACxB,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,MACxB,KAAA,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAEvB,MAAA,CACH,EAAG,KAAK,MAAU,IAAJ,GACd,EAAG,KAAK,MAAU,IAAJ,GACd,EAAG,KAAK,MAAU,IAAJ,IAMtB,OAAO,OAAS,WACZ,QAAQ,IAAI,UACR,IAAA,EAAY,QAChB,EAAe,SAAS,iBAAqC,uBACzD,IAAA,GAAQ,EAwDZ,sBAvDoB,SAAd,IACI,IAAA,EAAiB,EAAO,KAAK,MAE7B,EAAoB,GAAA,OAAA,KAAK,MAAM,EAAgB,KAAO,WAAW,SAAS,EAAG,KAAQ,KAAA,OAAA,KAAK,MAAO,EAAgB,IAAQ,IAAI,WAAW,SAAS,EAAG,MAGtJ,EAAgB,MAAS,IACzB,GAAQ,EACR,MAAM,kCAKL,IAFD,IAAA,EAAW,IAAI,IAEV,EAAI,EAAG,EAAI,EAAe,OAAQ,IACnC,EAAe,IAAM,EAAU,IAC/B,EAAS,IAAI,EAAG,EAAe,IAIjC,IAnBe,EAmBf,EAAY,SAAS,cAAc,cAAc,qBAAqB,MACjD,EAAA,EAAA,GApBN,IAAA,IAAA,EAAA,WAAA,IAAA,EAAA,EAAA,EAAA,MAAA,GAoBT,EApBS,EAAA,GAoBJ,EApBI,EAAA,GAqBb,EAAO,EACL,EAAK,EAAU,GACjB,IAAC,EAAI,MAAA,WACL,IAAA,GAAW,GACG,SAAZ,IACI,IAAA,EAAuC,GAAlC,EAAO,GAAM,EAAO,EAAO,GAEtC,EAAG,MAAM,UAA0B,cAAA,OAAA,EAAnC,OACA,EAAG,MAAM,QAAU,KAAK,IAAI,EAAY,EAAP,GAAW,WACxC,EAAO,KAAQ,IACf,GAAW,EACX,EAAG,YAAc,IAErB,GAAQ,MACI,EAAG,sBAAsB,IAEjC,EAAG,MAAM,QAAU,IACnB,EAAG,MAAM,UAAY,IAI7B,IAtBiC,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,IApBhB,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,IA+CrB,EAAY,EACR,EAAgB,IAAM,sBAAsB,IAE5C,SAAS,cAA8B,cAAc,MAAM,UAAY,oBACvE,QASZ,IAAM,EAAa,CACf,IACA,KACA,IACA,KAGW,EAAA,WAOC,SAAA,EAAA,EAAW,GAAS,EAAA,KAAA,GACvB,KAAA,EAAI,EACJ,KAAA,EAAI,EAgKhB,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,OA7JQ,MAAA,SAAA,GACI,KAAA,GAAK,KAAK,GAAK,EACf,KAAA,GAAK,KAAK,GAAK,EAEf,KAAA,IAAM,EAAI,EACV,KAAA,IAAM,EAAI,MAwJtB,EAzKc,GAuBT,EAAA,SAAA,GAkJL,EAAA,EAlJoB,GAkJpB,IAAA,EAAA,EAAA,GA/Ie,SAAA,EAAA,EAAW,GAAS,IAAA,EAAA,OAAA,EAAA,KAAA,IACtB,EAAA,EAAA,KAAA,KAAA,EAAG,IACJ,GAAK,EACL,EAAA,IAAM,IACN,EAAA,UAAY,KAAK,SAAW,EAAO,OAAS,EAAI,IAJzB,EA+InC,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,OAxIQ,MAAA,SAAA,GACU,EAAA,EAAA,EAAA,WAAA,OAAA,MAAA,KAAA,KAAA,GACN,KAAA,IAAM,KAsIlB,CAAA,IAAA,OAnIQ,MAAA,SAAA,GACD,EAAI,YAAc,oBAClB,EAAI,YACJ,EAAI,OAAO,KAAK,EAAG,KAAK,GACxB,EAAI,OAAO,KAAK,EAAG,KAAK,EAAI,IAC5B,EAAI,WA8HX,CAAA,IAAA,gBA3HgB,MAAA,WACF,OAAA,KAAK,EAAI,KAAK,cA0H5B,EAlJK,GA4BA,EAAA,SAAA,GAsHL,EAAA,EAtHmB,GAsHnB,IAAA,EAAA,EAAA,GAlHe,SAAA,EAAA,EAAW,EAAW,GAAY,IAAA,EAAA,EAAA,KAAA,IAEpC,EAAA,EAAA,KAAA,KAAA,EAAG,IAHb,IAAM,EAII,IAAA,EAAQ,KAAK,SAAW,KAAK,GAAK,EAClC,EAAqC,IAA7B,KAAK,IAAI,KAAK,SAAU,GAJI,OAKrC,EAAA,GAAK,KAAK,IAAI,GAAS,EACvB,EAAA,GAAK,KAAK,IAAI,GAAS,EACvB,EAAA,MAAQ,EACR,EAAA,SAAwC,EAA7B,KAAK,IAAI,KAAK,SAAU,GAAS,EARP,EAkHjD,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,OAvGQ,MAAA,SAAA,GAED,EAAI,UAAY,KAAK,MAAM,WAC3B,EAAI,SAAS,KAAK,EAAG,KAAK,EAAG,EAAG,KAoGvC,CAAA,IAAA,OAjGQ,MAAA,SAAA,GACU,EAAA,EAAA,EAAA,WAAA,OAAA,MAAA,KAAA,KAAA,GACN,KAAA,IAAM,EACN,KAAA,KAAO,EACN,IAAA,EAAQ,EAAK,KAAK,IAAM,KAAK,SAC9B,KAAA,MAAM,EAAI,MA4FtB,EAtHK,GA8BA,EAAA,WAKU,SAAA,EAAA,EAAW,EAAW,EAAW,GAAU,EAAA,KAAA,GAC9C,KAAA,EAAI,EACJ,KAAA,EAAI,EACJ,KAAA,EAAI,EACJ,KAAA,EAAI,GAAK,EA+ErB,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,WA5EW,MAAA,WACG,OAAU,GAAV,KAAK,EAAgB,OAAA,OAAA,KAAK,MAAM,KAAK,GAAO,MAAA,OAAA,KAAK,MAAM,KAAK,GAAO,MAAA,OAAA,KAAK,MAAM,KAAK,GAChF,KAAA,QAAA,OAAA,KAAK,MAAM,KAAK,GAAO,MAAA,OAAA,KAAK,MAAM,KAAK,GAAO,MAAA,OAAA,KAAK,MAAM,KAAK,GAAO,MAAA,OAAA,KAAK,EADpF,SA2EP,EAxFK,GAkBN,SAAS,IACL,QAAQ,IAAI,OACZ,EAAS,SAAS,cAAiC,sBAC5C,MAAQ,OAAO,WACtB,EAAO,OAAS,OAAO,YAElB,IADC,IAAA,EAAM,EAAO,WAAW,MACrB,EAAA,SAAA,GACL,WAAW,WACP,EAAa,GAAG,MAAM,UAAY,IACnC,EAAW,KAHT,EAAI,EAAG,EAAI,EAAW,OAAQ,IAA9B,EAAA,GAML,IAAA,EAAqB,GACrB,EAAoB,GAGf,SAAA,EAAY,GACjB,EAAQ,KAAK,IAAI,EAAO,EAAG,EAAO,OAAS,KAG1C,IAAA,IAAI,EAAI,EAAG,EAAI,EAAG,IACnB,EAAY,KAAK,SAAW,EAAO,OAGvC,QAAQ,IAAI,GACN,IAAA,EAAK,EAAI,GACX,EAAY,EA0ChB,sBAzCS,SAAA,IAEL,EAAI,UAAY,qBAChB,EAAI,SAAS,EAAG,EAAG,EAAO,MAAO,EAAO,QAGxB,IANP,EAMO,EAAA,EAAA,GANP,IAMgB,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CAAd,IAAA,EAAc,EAAA,MAIjB,GAFJ,EAAE,KAAK,GACP,EAAE,KAAK,GACH,EAAE,gBAGG,IAFC,IAAA,EAAO,KAAK,SAET,EAAI,EAAG,EAAI,IAAK,IAAK,CACpB,IAAA,EAAM,EAAS,EAA+B,IAAvB,KAAK,SAAW,IAAY,GAAK,GACxD,EAAS,IAAI,EAAM,EAAI,EAAG,EAAI,EAAG,EAAI,GAC3C,EAAU,KAAK,IAAI,EAAM,EAAE,EAAG,EAAE,EAAG,MAhBtC,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,IAqBT,IAEA,EAAU,EAAQ,OAAO,SAAA,GAAK,OAAC,EAAE,kBAE7B,EAAY,IAAM,EAAQ,OAAS,KACnC,EAAY,KAAK,SAAW,EAAO,OACnC,EAAY,GAGC,IA9BR,EA8BQ,EAAA,EAAA,GA9BR,IA8BmB,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CAAjB,IAAA,EAAiB,EAAA,MACxB,EAAG,KAAK,GACR,EAAG,KAAK,IAhCH,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,IAmCT,EAAY,EAAU,OAAO,SAAA,GAAK,OAAA,EAAE,IAAM,EAAE,WAE5C,sBAAsB","file":"sylvester.5b9afcc9.js","sourceRoot":"..","sourcesContent":["const ZERO = Date.now() + 1000 * 15\r\nlet yearElements: NodeListOf<HTMLHeadingElement>\r\nlet canvas: HTMLCanvasElement\r\n\r\n\r\n\r\nfunction HSVtoRGB(h: number, s: number, v: number) {\r\n    var r, g, b, i, f, p, q, t;\r\n    i = Math.floor(h * 6);\r\n    f = h * 6 - i;\r\n    p = v * (1 - s);\r\n    q = v * (1 - f * s);\r\n    t = v * (1 - (1 - f) * s);\r\n    switch (i % 6) {\r\n        case 0: r = v, g = t, b = p; break;\r\n        case 1: r = q, g = v, b = p; break;\r\n        case 2: r = p, g = v, b = t; break;\r\n        case 3: r = p, g = q, b = v; break;\r\n        case 4: r = t, g = p, b = v; break;\r\n        case 5: r = v, g = p, b = q; break;\r\n    }\r\n    return {\r\n        r: Math.round(r * 255),\r\n        g: Math.round(g * 255),\r\n        b: Math.round(b * 255)\r\n    };\r\n}\r\n\r\n\r\n\r\nwindow.onload = () => {\r\n    console.log('loaded')\r\n    let lastTimer = '00:00'\r\n    yearElements = document.querySelectorAll<HTMLHeadingElement>('#fireworks #year h1')\r\n    let fired = false\r\n    const updateTimer = () => {\r\n        const secsRemaining = (ZERO - Date.now())\r\n        //console.log(secsRemaining)\r\n        const ssecsRemaining = `${Math.floor(secsRemaining / 60000).toString().padStart(2, '0')}:${Math.floor((secsRemaining / 1000) % 60).toString().padStart(2, '0')}`\r\n\r\n\r\n        if (secsRemaining < 5000 && !fired) {\r\n            fired = true\r\n            fetch('http://raspberrypi3:8080/boom')\r\n        }\r\n\r\n        let diffsMap = new Map<number, string>();\r\n\r\n        for (let i = 0; i < ssecsRemaining.length; i++) {\r\n            if (ssecsRemaining[i] != lastTimer[i]) {\r\n                diffsMap.set(i, ssecsRemaining[i])\r\n            }\r\n        }\r\n\r\n        const allDigits = document.querySelector('#countdown').getElementsByTagName('h1')\r\n        for (const [idx, nChar] of diffsMap) {\r\n            let time = 0.0\r\n            const el = allDigits[idx]\r\n            if (!el) continue\r\n            let switched = false\r\n            const transAnim = () => {\r\n                const y = (time < 0.5 ? time : time - 1.0) * 2.\r\n                //console.log(y)\r\n                el.style.transform = `translateY(${y}em)`\r\n                el.style.opacity = Math.abs(1 - (time * 2)).toString()\r\n                if (time > 0.5 && !switched) {\r\n                    switched = true\r\n                    el.textContent = nChar\r\n                }\r\n                time += 0.05\r\n                if (time <= 1) requestAnimationFrame(transAnim)\r\n                else {\r\n                    el.style.opacity = '1'\r\n                    el.style.transform = ''\r\n                }\r\n            }\r\n\r\n            transAnim()\r\n\r\n        }\r\n        //console.log(ssecsRemaining)\r\n        //document.querySelector('#countdown > h1').textContent = \r\n        lastTimer = ssecsRemaining\r\n        if (secsRemaining > 1000) requestAnimationFrame(updateTimer)\r\n        else {\r\n            document.querySelector<HTMLDivElement>('#countdown').style.transform = 'translateY(100vh)'\r\n            startFireworks()\r\n        }\r\n    }\r\n\r\n    requestAnimationFrame(updateTimer)\r\n\r\n}\r\n\r\n\r\nconst yearDelays = [\r\n    142,\r\n    1142,\r\n    412,\r\n    813\r\n]\r\n\r\nabstract class Particle {\r\n    x: number;\r\n    y: number;\r\n\r\n    vx: number;\r\n    vy: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x\r\n        this.y = y\r\n    }\r\n\r\n    step(dt: number) {\r\n        this.x += this.vx * dt\r\n        this.y += this.vy * dt\r\n\r\n        this.vx *= 1 - dt\r\n        this.vy *= 1 - dt\r\n    }\r\n\r\n    abstract draw(ctx: CanvasRenderingContext2D)\r\n}\r\n\r\nclass Rocket extends Particle {\r\n    private maxHeight: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y)\r\n        this.vx = 0\r\n        this.vy = -100\r\n        this.maxHeight = Math.random() * canvas.height / 2 + 100\r\n    }\r\n\r\n    step(dt: number) {\r\n        super.step(dt)\r\n        this.vy -= 10\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        ctx.strokeStyle = 'rgb(255, 100, 70)'\r\n        ctx.beginPath()\r\n        ctx.moveTo(this.x, this.y)\r\n        ctx.lineTo(this.x, this.y + 10)\r\n        ctx.stroke()\r\n    }\r\n\r\n    shouldExplode(): boolean {\r\n        return this.y < this.maxHeight\r\n    }\r\n}\r\n\r\nclass Spark extends Particle {\r\n    color: Color; // rgba \r\n    lifetime: number;\r\n    age = 0;\r\n    constructor(x: number, y: number, color: Color) {\r\n        //console.log(color.toString(16))\r\n        super(x, y)\r\n        const angle = Math.random() * Math.PI * 2\r\n        const force = Math.pow(Math.random(), 2) * 200\r\n        this.vx = Math.sin(angle) * force\r\n        this.vy = Math.cos(angle) * force\r\n        this.color = color\r\n        this.lifetime = Math.pow(Math.random(), 1) * 3 + 1 \r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        \r\n        ctx.fillStyle = this.color.toString()\r\n        ctx.fillRect(this.x, this.y, 2, 2)\r\n    } \r\n\r\n    step(dt: number) {\r\n        super.step(dt)\r\n        this.vy += 1\r\n        this.age += dt\r\n        const alpha = 1 - (this.age / this.lifetime)\r\n        this.color.a = alpha\r\n    }\r\n}\r\n\r\nclass Color {\r\n    r: number;\r\n    g: number;\r\n    b: number;\r\n    a: number\r\n    constructor(r: number, g: number, b: number, a?: number) {\r\n        this.r = r\r\n        this.g = g\r\n        this.b = b\r\n        this.a = a || 1.\r\n    }\r\n\r\n    toString(): string {\r\n        return this.a == 1 ? `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})` \r\n        : `rgba(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)}, ${this.a})`\r\n    }\r\n}\r\n\r\nfunction startFireworks() {\r\n    console.log('fw')\r\n    canvas = document.querySelector<HTMLCanvasElement>('#fireworks canvas')\r\n    canvas.width = window.innerWidth\r\n    canvas.height = window.innerHeight\r\n    const ctx = canvas.getContext('2d')\r\n    for (let i = 0; i < yearDelays.length; i++) {\r\n        setTimeout(() => {\r\n            yearElements[i].style.transform = ''\r\n        }, yearDelays[i])\r\n    }\r\n\r\n    let particles: Spark[] = []\r\n    let rockets: Rocket[] = []\r\n\r\n\r\n    function spawnRocket(x: number) {\r\n        rockets.push(new Rocket(x, canvas.height + 20))\r\n    }\r\n\r\n    for (let i = 0; i < 6; i++) {\r\n        spawnRocket(Math.random() * canvas.width)\r\n    }\r\n\r\n    console.log(rockets)\r\n    const dt = 1 / 60\r\n    let lastSpawn = 0\r\n    function draw() {\r\n        \r\n        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n\r\n        //debugger\r\n        for (const r of rockets) {\r\n            //console.log(r.x, r.y)\r\n            r.draw(ctx)\r\n            r.step(dt)\r\n            if (r.shouldExplode()) {\r\n                const bHue = Math.random()\r\n                //debugger\r\n                for (let i = 0; i < 100; i++) {\r\n                    const col = HSVtoRGB(bHue + (Math.random() - 0.5) * 0.1, 0.5, 1.)\r\n                    const bColor = new Color(col.r, col.g, col.b)\r\n                    particles.push(new Spark(r.x, r.y, bColor))\r\n                }\r\n            }\r\n        }\r\n\r\n        lastSpawn++\r\n\r\n        rockets = rockets.filter(r => !r.shouldExplode())\r\n\r\n        if (lastSpawn > 20 && rockets.length < 10) {\r\n            spawnRocket(Math.random() * canvas.width)\r\n            lastSpawn = 0\r\n        }\r\n\r\n        for (const sp of particles) {\r\n            sp.draw(ctx)\r\n            sp.step(dt)\r\n        }\r\n\r\n        particles = particles.filter(p => p.age < p.lifetime)\r\n        \r\n        requestAnimationFrame(draw)\r\n    }\r\n\r\n\r\n    requestAnimationFrame(draw)\r\n\r\n}\r\n"]}