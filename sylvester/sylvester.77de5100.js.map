{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"sylvester.77de5100.js","sourceRoot":"..","sourcesContent":["const ZERO = Date.now() + 1000 * 15\r\nlet yearElements: NodeListOf<HTMLHeadingElement>\r\nlet canvas: HTMLCanvasElement\r\n\r\n\r\n\r\nfunction HSVtoRGB(h: number, s: number, v: number) {\r\n    var r, g, b, i, f, p, q, t;\r\n    i = Math.floor(h * 6);\r\n    f = h * 6 - i;\r\n    p = v * (1 - s);\r\n    q = v * (1 - f * s);\r\n    t = v * (1 - (1 - f) * s);\r\n    switch (i % 6) {\r\n        case 0: r = v, g = t, b = p; break;\r\n        case 1: r = q, g = v, b = p; break;\r\n        case 2: r = p, g = v, b = t; break;\r\n        case 3: r = p, g = q, b = v; break;\r\n        case 4: r = t, g = p, b = v; break;\r\n        case 5: r = v, g = p, b = q; break;\r\n    }\r\n    return {\r\n        r: Math.round(r * 255),\r\n        g: Math.round(g * 255),\r\n        b: Math.round(b * 255)\r\n    };\r\n}\r\n\r\n\r\n\r\nwindow.onload = () => {\r\n    console.log('loaded')\r\n    let lastTimer = '00:00'\r\n    yearElements = document.querySelectorAll<HTMLHeadingElement>('#fireworks #year h1')\r\n    let fired = false\r\n    const updateTimer = () => {\r\n        const secsRemaining = (ZERO - Date.now())\r\n        //console.log(secsRemaining)\r\n        const ssecsRemaining = `${Math.floor(secsRemaining / 60000).toString().padStart(2, '0')}:${Math.floor((secsRemaining / 1000) % 60).toString().padStart(2, '0')}`\r\n\r\n\r\n        if (secsRemaining < 5000 && !fired) {\r\n            fired = true\r\n            fetch('http://raspberrypi3:8080/boom')\r\n        }\r\n\r\n        let diffsMap = new Map<number, string>();\r\n\r\n        for (let i = 0; i < ssecsRemaining.length; i++) {\r\n            if (ssecsRemaining[i] != lastTimer[i]) {\r\n                diffsMap.set(i, ssecsRemaining[i])\r\n            }\r\n        }\r\n\r\n        const allDigits = document.querySelector('#countdown').getElementsByTagName('h1')\r\n        for (const [idx, nChar] of diffsMap) {\r\n            let time = 0.0\r\n            const el = allDigits[idx]\r\n            if (!el) continue\r\n            let switched = false\r\n            const transAnim = () => {\r\n                const y = (time < 0.5 ? time : time - 1.0) * 2.\r\n                //console.log(y)\r\n                el.style.transform = `translateY(${y}em)`\r\n                el.style.opacity = Math.abs(1 - (time * 2)).toString()\r\n                if (time > 0.5 && !switched) {\r\n                    switched = true\r\n                    el.textContent = nChar\r\n                }\r\n                time += 0.05\r\n                if (time <= 1) requestAnimationFrame(transAnim)\r\n                else {\r\n                    el.style.opacity = '1'\r\n                    el.style.transform = ''\r\n                }\r\n            }\r\n\r\n            transAnim()\r\n\r\n        }\r\n        //console.log(ssecsRemaining)\r\n        //document.querySelector('#countdown > h1').textContent = \r\n        lastTimer = ssecsRemaining\r\n        if (secsRemaining > 1000) requestAnimationFrame(updateTimer)\r\n        else {\r\n            document.querySelector<HTMLDivElement>('#countdown').style.transform = 'translateY(100vh)'\r\n            startFireworks()\r\n        }\r\n    }\r\n\r\n    requestAnimationFrame(updateTimer)\r\n\r\n}\r\n\r\n\r\nconst yearDelays = [\r\n    142,\r\n    1142,\r\n    412,\r\n    813\r\n]\r\n\r\nabstract class Particle {\r\n    x: number;\r\n    y: number;\r\n\r\n    vx: number;\r\n    vy: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x\r\n        this.y = y\r\n    }\r\n\r\n    step(dt: number) {\r\n        this.x += this.vx * dt\r\n        this.y += this.vy * dt\r\n\r\n        this.vx *= 1 - dt\r\n        this.vy *= 1 - dt\r\n    }\r\n\r\n    abstract draw(ctx: CanvasRenderingContext2D)\r\n}\r\n\r\nclass Rocket extends Particle {\r\n    private maxHeight: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        super(x, y)\r\n        this.vx = 0\r\n        this.vy = -100\r\n        this.maxHeight = Math.random() * canvas.height / 2 + 100\r\n    }\r\n\r\n    step(dt: number) {\r\n        super.step(dt)\r\n        this.vy -= 10\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        ctx.strokeStyle = 'rgb(255, 100, 70)'\r\n        ctx.beginPath()\r\n        ctx.moveTo(this.x, this.y)\r\n        ctx.lineTo(this.x, this.y + 10)\r\n        ctx.stroke()\r\n    }\r\n\r\n    shouldExplode(): boolean {\r\n        return this.y < this.maxHeight\r\n    }\r\n}\r\n\r\nclass Spark extends Particle {\r\n    color: Color; // rgba \r\n    lifetime: number;\r\n    age = 0;\r\n    constructor(x: number, y: number, color: Color) {\r\n        //console.log(color.toString(16))\r\n        super(x, y)\r\n        const angle = Math.random() * Math.PI * 2\r\n        const force = Math.pow(Math.random(), 2) * 200\r\n        this.vx = Math.sin(angle) * force\r\n        this.vy = Math.cos(angle) * force\r\n        this.color = color\r\n        this.lifetime = Math.pow(Math.random(), 1) * 3 + 1 \r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        \r\n        ctx.fillStyle = this.color.toString()\r\n        ctx.fillRect(this.x, this.y, 2, 2)\r\n    } \r\n\r\n    step(dt: number) {\r\n        super.step(dt)\r\n        this.vy += 1\r\n        this.age += dt\r\n        const alpha = 1 - (this.age / this.lifetime)\r\n        this.color.a = alpha\r\n    }\r\n}\r\n\r\nclass Color {\r\n    r: number;\r\n    g: number;\r\n    b: number;\r\n    a: number\r\n    constructor(r: number, g: number, b: number, a?: number) {\r\n        this.r = r\r\n        this.g = g\r\n        this.b = b\r\n        this.a = a || 1.\r\n    }\r\n\r\n    toString(): string {\r\n        return this.a == 1 ? `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})` \r\n        : `rgba(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)}, ${this.a})`\r\n    }\r\n}\r\n\r\nfunction startFireworks() {\r\n    console.log('fw')\r\n    canvas = document.querySelector<HTMLCanvasElement>('#fireworks canvas')\r\n    canvas.width = window.innerWidth\r\n    canvas.height = window.innerHeight\r\n    const ctx = canvas.getContext('2d')\r\n    for (let i = 0; i < yearDelays.length; i++) {\r\n        setTimeout(() => {\r\n            yearElements[i].style.transform = ''\r\n        }, yearDelays[i])\r\n    }\r\n\r\n    let particles: Spark[] = []\r\n    let rockets: Rocket[] = []\r\n\r\n\r\n    function spawnRocket(x: number) {\r\n        rockets.push(new Rocket(x, canvas.height + 20))\r\n    }\r\n\r\n    for (let i = 0; i < 6; i++) {\r\n        spawnRocket(Math.random() * canvas.width)\r\n    }\r\n\r\n    console.log(rockets)\r\n    const dt = 1 / 60\r\n    let lastSpawn = 0\r\n    function draw() {\r\n        \r\n        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n\r\n        //debugger\r\n        for (const r of rockets) {\r\n            //console.log(r.x, r.y)\r\n            r.draw(ctx)\r\n            r.step(dt)\r\n            if (r.shouldExplode()) {\r\n                const bHue = Math.random()\r\n                //debugger\r\n                for (let i = 0; i < 100; i++) {\r\n                    const col = HSVtoRGB(bHue + (Math.random() - 0.5) * 0.1, 0.5, 1.)\r\n                    const bColor = new Color(col.r, col.g, col.b)\r\n                    particles.push(new Spark(r.x, r.y, bColor))\r\n                }\r\n            }\r\n        }\r\n\r\n        lastSpawn++\r\n\r\n        rockets = rockets.filter(r => !r.shouldExplode())\r\n\r\n        if (lastSpawn > 20 && rockets.length < 10) {\r\n            spawnRocket(Math.random() * canvas.width)\r\n            lastSpawn = 0\r\n        }\r\n\r\n        for (const sp of particles) {\r\n            sp.draw(ctx)\r\n            sp.step(dt)\r\n        }\r\n\r\n        particles = particles.filter(p => p.age < p.lifetime)\r\n        \r\n        requestAnimationFrame(draw)\r\n    }\r\n\r\n\r\n    requestAnimationFrame(draw)\r\n\r\n}\r\n"]}